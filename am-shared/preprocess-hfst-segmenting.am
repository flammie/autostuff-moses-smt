## Include to automake project to use HFST segments for translations.

# FST's segments
%.hfst.1best-comp.tok.$(L2): %.tok.$(L2) $(HFST_L2_COMPOUNDS)
	$(IRSTLM_ADD_START_END) < $< | tr ' ' '\n' |\
		$(HFST_LOOKUP) -q $(HFST_L2_COMPOUNDS) | $(SED) -e 's/^$$//' | tr '\n' '@' |\
		tr  '\n' |\
		cut -f 2 | tr '\n' ' ' | $(SED) -e 's/+?//g' -e 's:</s>:\0\n:g' |\
		head -n -1 |\
		$(IRSTLM_RM_START_END) > $@

%.hfst.1best-morphs.tok.$(L2): %.tok.$(L2) $(HFST_L2_MORPHS)
	$(IRSTLM_ADD_START_END) < $< | tr ' ' '\n' |\
		$(HFST_LOOKUP) -q $(HFST_L2_MORPHS) | $(SED) -e 's/^$$//' | tr '\n' '@' |\
		tr  '\n' |\
		cut -f 2 | tr '\n' ' ' | $(SED) -e 's/+?//g' -e 's:</s>:\0\n:g' |\
		head -n -1 |\
		$(IRSTLM_RM_START_END) > $@

%.hfst.1best-factored.tok.$(L2): %.tok.$(L2) $(HFST_L2_MARKS)
	$(IRSTLM_ADD_START_END) < $< | tr ' ' '\n' |\
		$(HFST_LOOKUP) -P -q $(HFST_L2_MORPHS) | $(SED) -e 's/^$$//' | tr '\n' '@' |\
		tr  '\n' |\
		cut -f 1,2 | tr '\n' ' ' | $(SED) -e 's/+?//g' -e 's:</s>:\0\n:g' |\
		head -n -1 |\
		sed -e 's/\t/|/' -e 's/{WB}/+/g' -e 's/{MB}/|/' -e 's/{MB}/./g' |\
		$(IRSTLM_RM_START_END) > $@

# experimenting with different markers
%.hfst.1best-comp.nomarkers.tok.$(L2): %.hfst.1best-comp.tok.$(L2)
	sed -e 's/→ ←/ /g' < $< > $@

%.hfst.1best-morphs.nomarkers.tok.$(L2): %.hfst.1best-morphs.tok.$(L2)
	sed -e 's/→ ←/ /g' < $< > $@

%.hfst.1best-comp.spaceplusspace.tok.$(L2): %.hfst.1best-comp.tok.$(L2)
	sed -e 's/→ ←/ + /g' < $< > $@

%.hfst.1best-morphs.spaceplusspace.tok.$(L2): %.hfst.1best-morphs.tok.$(L2)
	sed -e 's/→ ←/ + /g' < $< > $@

%.hfst.1best-comp.suffixmarkered.tok.$(L2): %.hfst.1best-comp.tok.$(L2)
	sed -e 's/→ ←/ ←/g' < $< > $@

%.hfst.1best-morphs.suffixmarkered.tok.$(L2): %.hfst.1best-morphs.tok.$(L2)
	sed -e 's/→ ←/ ←/g' < $< > $@



# For translation with prefix rules, the L1 tokenisation for morphs is the
# same as words
%.hfst.1best-comp.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

%.hfst.1best-morphs.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

%.hfst.1best-comp.nomarkers.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

%.hfst.1best-morphs.nomarkers.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

%.hfst.1best-comp.spaceplusspace.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

%.hfst.1best-morphs.spaceplusspace.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

%.hfst.1best-comp.suffixmarkered.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

%.hfst.1best-morphs.suffixmarkered.tok.$(L1): %.tok.$(L1)
	cp -v $< $@

# tuning set namings
# tuning set naming
%.hfst.1best-morphs.tune.tok.$(L1): %.tune.tok.$(L1)
	cp -v $< $@

%.hfst.1best-morphs.tune.tok.$(L2): %.tune.hfst.1best-morphs.tok.$(L2)
	cp -v $< $@

%.hfst.1best-comp.tune.tok.$(L1): %.tune.tok.$(L1)
	cp -v $< $@

%.hfst.1best-comp.tune.tok.$(L2): %.tune.hfst.1best-comp.tok.$(L2)
	cp -v $< $@


# vim: set ft=automake:
